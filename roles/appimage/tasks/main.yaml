# AppImages requires FUSE.
- name: Install FUSE for Arch distributions
  become: yes
  pacman:
    name: fuse3
  when: ansible_pkg_mgr == "pacman" and ansible_architecture == "x86_64"

- name: Install AppImageLauncher for Arch distributions
  become_user: "{{ user_account }}"
  shell:
    cmd: yay -Sy --noconfirm appimagelauncher-git
  when: ansible_pkg_mgr == "pacman"

- name: Create AppImages directory for Linux
  become: yes
  file:
    path: /usr/local/appimages
    state: directory
  when: ansible_system == "Linux"

- name: Copy AppImageLauncher settings file for Linux
  become: yes
  copy:
    dest: "{{ user_home_dir }}/.config/appimagelauncher.cfg"
    mode: 0644
    src: appimagelauncher.cfg
  when: ansible_system == "Linux"

- name: Install AppImage packages for Linux
  become: yes
  get_url:
    dest: /usr/local/appimages/{{ item.name }}
    mode: 0755
    url: "{{ item.url }}"
  loop: "{{ appimage_packages }}"
  when: ansible_system == "Linux"
