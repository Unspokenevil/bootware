---
- name: Enable passwordless sudo for Unix
  ansible.builtin.blockinfile:
    block: |
      # Enable passwordless sudo for {{ ansible_user_id }} user.
      {{ ansible_user_id }} ALL=(ALL) NOPASSWD:ALL
    create: true
    mode: "440"
    owner: root
    path: /etc/sudoers
    validate: /usr/sbin/visudo -cf %s
  become: true
  when: passwordless_sudo and ansible_system != "Win32NT"
