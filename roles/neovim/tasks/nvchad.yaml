---
- name: Download NvChad for Unix
  ansible.builtin.git:
    depth: 1
    dest: /tmp/NvChad
    repo: https://github.com/NvChad/NvChad
  when: ansible_system != "Win32NT"

- name: Install NvChad for Unix
  ansible.builtin.copy:
    dest: "{{ ansible_env.HOME }}/.config/nvim/{{ item }}"
    mode: "755"
    src: "/tmp/NvChad/{{ item }}"
  loop:
    - init.lua
    - lua
  when: ansible_system != "Win32NT"

- name: Remove Neovim settings file for Unix
  ansible.builtin.file:
    path: "{{ ansible_env.HOME }}/.config/nvim/init.vim"
    state: absent
  when: ansible_system != "Win32NT"

- name: Install NvChad configuration file for Unix
  ansible.builtin.copy:
    dest: "{{ ansible_env.HOME }}/.config/nvim/lua/custom/"
    mode: "664"
    src: chadrc.lua
  when: ansible_system != "Win32NT"

- name: Download NvChad for Windows
  ansible.builtin.win_command: >-
    git clone --depth 1 https://github.com/NvChad/NvChad {{ ansible_env.HOME
    }}/AppData/Local/Temp/NvChad
  when: ansible_system == "Win32NT"

- name: Install NvChad for Windows
  ansible.windows.win_copy:
    dest: "{{ ansible_env.HOME }}/AppData/Local/nvim/{{ item }}"
    src: "{{ ansible_env.HOME }}/AppData/Local/Temp/NvChad/{{ item }}"
  loop:
    - init.lua
    - lua
  when: ansible_system == "Win32NT"

- name: Remove Neovim settings file for Windows
  ansible.windows.win_file:
    path: "{{ ansible_env.HOME }}/AppData/Local/nvim/init.vim"
    state: absent
  when: ansible_system == "Win32NT"

- name: Install NvChad configuration file for Windows
  ansible.windows.win_copy:
    dest: "{{ ansible_env.HOME }}/AppData/Local/nvim/lua/custom/"
    src: chadrc.lua
  when: ansible_system == "Win32NT"
