---
- name: Download NvChad for Unix
  git:
    depth: 1
    dest: /tmp/NvChad
    repo: https://github.com/NvChad/NvChad
  when: ansible_system != "Win32NT"

- name: Install NvChad for Unix
  copy:
    dest: "{{ ansible_env.HOME }}/.config/nvim/{{ item }}"
    mode: "755"
    src: "/tmp/NvChad/{{ item }}"
  loop:
    - init.lua
    - lua
  when: ansible_system != "Win32NT"

- name: Remove Neovim settings file for Unix
  file:
    path: "{{ ansible_env.HOME }}/.config/nvim/init.vim"
    state: absent
  when: ansible_system != "Win32NT"

- name: Install NvChad configuration file for Unix
  copy:
    dest: "{{ ansible_env.HOME }}/.config/nvim/lua/custom/"
    mode: "664"
    src: chadrc.lua
  when: ansible_system != "Win32NT"

- name: Download NvChad for Windows
  when: ansible_system == "Win32NT"
  win_shell: >-
    git clone --depth 1 https://github.com/NvChad/NvChad {{ ansible_env.HOME
    }}/AppData/Local/Temp/NvChad

- name: Install NvChad for Windows
  loop:
    - init.lua
    - lua
  when: ansible_system == "Win32NT"
  win_copy:
    dest: "{{ ansible_env.HOME }}/AppData/Local/nvim/{{ item }}"
    src: "{{ ansible_env.HOME }}/AppData/Local/Temp/NvChad/{{ item }}"

- name: Remove Neovim settings file for Windows
  when: ansible_system == "Win32NT"
  win_file:
    path: "{{ ansible_env.HOME }}/AppData/Local/nvim/init.vim"
    state: absent

- name: Install NvChad configuration file for Windows
  when: ansible_system == "Win32NT"
  win_copy:
    dest: "{{ ansible_env.HOME }}/AppData/Local/nvim/lua/custom/"
    src: chadrc.lua
