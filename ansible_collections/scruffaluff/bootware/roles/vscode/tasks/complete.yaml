- name: Check for VSCode Fish completions for Linux
  ansible.builtin.stat:
    path: "{{ fish_vendor_completion }}/code.fish"
  register: vscode_fish_completion_check
  tags:
    - install
  when: ansible_system != "Win32NT"

- name: Add VSCodium Fish completions for Linux
  ansible.builtin.copy:
    dest: "{{ fish_completion }}/codium.fish"
    force: true
    mode: "644"
    remote_src: true
    src: "{{ fish_vendor_completion }}/code.fish"
  become: true
  tags:
    - install
  when: ansible_system != "Win32NT" and vscode_fish_completion_check.stat.exists

- name: Update VSCodium Fish completions for Linux
  ansible.builtin.replace:
    path: "{{ fish_completion }}/codium.fish"
    regexp: code
    replace: codium
  become: true
  tags:
    - install
  when: ansible_system != "Win32NT" and vscode_fish_completion_check.stat.exists
